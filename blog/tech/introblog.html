<!DOCTYPE html> <html lang="en"> <head> <!-- 2025-03-24 Mon 21:30 --> <meta charset="utf-8"> <title> Building this website </title> <meta name="author" content="Pranshu Sharma"> <meta name="generator" content="Org Mode"> <link href="https://cdn.jsdelivr.net/npm/typeface-et-book@0.0/et-book/et-book.min.css%20" rel="stylesheet"> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="icon" type="image/x-icon" href="../../asset/favicon.png"> <style type="text/css"> #content { max-width: 60em; margin: auto; } .subtitle { text-align: center; font-size: medium; font-weight: bold; margin-top:0; } .todo { font-family: monospace; color: red; } .done { font-family: monospace; color: green; } .priority { font-family: monospace; color: orange; } .tag { background-color: #eee; font-family: monospace; padding: 2px; font-size: 80%; font-weight: normal; } .timestamp { color: #bebebe; } .timestamp-kwd { color: #5f9ea0; } .org-right { margin-left: auto; margin-right: 0px; text-align: right; } .org-left { margin-left: 0px; margin-right: auto; text-align: left; } .org-center { margin-left: auto; margin-right: auto; text-align: center; } .underline { text-decoration: underline; } #postamble p, #preamble p { font-size: 90%; margin: .2em; } p.verse { margin-left: 3%; } pre { border: 1px solid #e6e6e6; border-radius: 3px; background-color: #f2f2f2; padding: 8pt; font-family: monospace; overflow: auto; margin: 1.2em; } pre.src { position: relative; overflow: auto; } table { border-collapse:collapse; } caption.t-above { caption-side: top; } caption.t-bottom { caption-side: bottom; } td, th { vertical-align:top; } th.org-right { text-align: center; } th.org-left { text-align: center; } th.org-center { text-align: center; } td.org-right { text-align: right; } td.org-left { text-align: left; } td.org-center { text-align: center; } dt { font-weight: bold; } .footpara { display: inline; } .footdef { margin-bottom: 1em; } .figure { padding: 1em; } .figure p { text-align: center; } .equation-container { display: table; text-align: center; width: 100%; } .equation { vertical-align: middle; } .equation-label { display: table-cell; text-align: right; vertical-align: middle; } .inlinetask { padding: 10px; border: 2px solid gray; margin: 10px; background: #ffffcc; } #org-div-home-and-up { text-align: right; font-size: 70%; white-space: nowrap; } textarea { overflow-x: auto; } .linenr { font-size: smaller } .code-highlighted { background-color: #ffff00; } .org-info-js_search-highlight { background-color: #ffff00; color: #000000; font-weight: bold; } .org-svg { } </style> <link rel="stylesheet" href="../../asset/tufte.css" type="text/css"> <link rel="stylesheet" href="../../asset/fonts.css" type="text/css"> <link rel="stylesheet" href="../../asset/ox-tufte.css" type="text/css"> <link rel="stylesheet" href="../../asset/main.css" type="text/css"> <script> window.MathJax = { tex: { ams: { multlineWidth: '85%' }, tags: 'ams', tagSide: 'right', tagIndent: '.8em' }, chtml: { scale: 1.0, displayAlign: 'center', displayIndent: '0em' }, svg: { scale: 1.0, displayAlign: 'center', displayIndent: '0em' }, output: { font: 'mathjax-modern', displayOverflow: 'overflow' } }; </script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"> </script> </head> <body> <nav class="navbar"> <ul> <li><a href="../../"> Home </a></li> <li><a href="../"> Blog </a></li> </ul> </nav> <h3 style="text-align: center; margin-bottom: -1em; margin-top: 1em;color: green;"> 2025-04-05 </h3> <article id="content" class="content"> <header> <h1 class="title">Building this website</h1> </header><nav id="table-of-contents" role="doc-toc"> <h2>Table of Contents</h2> <div id="text-table-of-contents" role="doc-toc"> <ul> <li><a href="introblog.html#orgd98eb26">Intro</a></li> <li> <a href="introblog.html#org7925b9e">Criteria</a> <ul> <li> <a href="introblog.html#orgee35afe">Comparasion of other static site generators</a> <ul> <li><a href="introblog.html#org0ce0959">Hugo/jekyll</a></li> <li><a href="introblog.html#org9639605">Org publish</a></li> </ul> </li> </ul> </li> <li> <a href="introblog.html#org7f6f53b">The solution</a> <ul> <li> <a href="introblog.html#orgfa898cb"><code>genorg</code></a> <ul> <li><a href="introblog.html#org7161a33">Why perl?</a></li> </ul> </li> <li><a href="introblog.html#org194cf40"><code>genserve</code></a></li> </ul> </li> <li><a href="introblog.html#org0043671">Code</a></li> <li><a href="introblog.html#org0c8fbd7">What now?</a></li> </ul> </div> </nav> <section id="outline-container-orgd98eb26" class="outline-2"> <h2 id="orgd98eb26">Intro</h2> <div class="outline-text-2" id="text-orgd98eb26"> <p> Right after spending about 2 weeks in making <i>genorg</i>, my supreme and <i>functioning</i> (most of the time) static site generator<label id="fnr.1" for="fnr-in.1.7953239" class="margin-toggle sidenote-number"><sup class="numeral">1</sup></label><input type="checkbox" id="fnr-in.1.7953239" class="margin-toggle"><span class="sidenote"><sup class="numeral">1</sup> Well, technically <i>genorg</i> does also have a dynamic part to it. </span>, here are the hows and whys. </p> <figure id="org99c01cb"> <img src="../../2025/data/ae/f1ed64-38e9-442e-a1ed-5229042e596d/2025-04-27_22-10-50_1600093582038.jpeg" alt="2025-04-27_22-10-50_1600093582038.jpeg"> </figure> </div> </section> <section id="outline-container-org7925b9e" class="outline-2"> <h2 id="org7925b9e">Criteria</h2> <div class="outline-text-2" id="text-org7925b9e"> <blockquote> <p> My criteria compared to your career just isn't fair </p> <footer>Lil Wayne, in his song 'A Milli'</footer> </blockquote> <ul class="org-ul"> <li>The <del>markup</del> document type for the a blog article should be <a href="https://orgmode.org/">Org</a>, or something as powerful(void).</li> <li>The org to html function should be complete and work well. Currently (and eternally), this is only done by the emacs org exporter itself.</li> <li>Categories</li> <li>Moving files around in the 'articles' directory should still produce the same output blog. This means that the category info would need to be in the article file itself.</li> <li>A powerful and flexible templating system. This would be used for example to export to the blog page.</li> <li>Rss feeds.</li> </ul> </div> <div id="outline-container-orgee35afe" class="outline-3"> <h3 id="orgee35afe">Comparasion of other static site generators</h3> <div class="outline-text-3" id="text-orgee35afe"> <p> Before I decided to make my own thing, I tried to find other static site generator that would meet this criteria. At the end, I was left with 2 valid options. </p> </div> <div id="outline-container-org0ce0959" class="outline-4"> <h4 id="org0ce0959">Hugo/jekyll</h4> <div class="outline-text-4" id="text-org0ce0959"> <p> The compromise here would be using the shabby hugo org export, or use Hugo. However, this could pretty much be fixed by using <a href="http://ox-hugo.scripter.co">ox-hugo</a>. Now I look back at it, this would probably have been the better choice. oh well, I'm happy with I have now. I reccomend this to to all readers who have a similar criteria. </p> <p> Plus, using Hugo would remind me too much of the <a href="https://en.wikipedia.org/wiki/Hugo_(film)">film</a> with the same name which I vaguely remember watching, hence forcing me to rewatch and waste 2 hours. </p> </div> </div> <div id="outline-container-org9639605" class="outline-4"> <h4 id="org9639605">Org publish</h4> <div class="outline-text-4" id="text-org9639605"> <p> I couldn't move files, plus I would have to hand maintain the category pages. No thanks, I got better things to do (<i>gulp</i>). </p> </div> </div> </div> </section> <section id="outline-container-org7f6f53b" class="outline-2"> <h2 id="org7f6f53b">The solution</h2> <div class="outline-text-2" id="text-org7f6f53b"> <p> Writing about programming instead of just programming kinda sucks, bear with me. </p> </div> <div id="outline-container-orgfa898cb" class="outline-3"> <h3 id="orgfa898cb"><code>genorg</code></h3> <div class="outline-text-3" id="text-orgfa898cb"> <p> <code>genorg</code> is a perl script which generates the sites from a input directory and a TOML configuration file. It scours and converts a bunch of org files in the directory, and converts them to html (if needed). Each of these files contain a <i>id</i> for internal use, and a <i>category</i>. </p> <div class="org-src-container"> <pre class="src src-nil"> Input Cache Output +-----------+ +---------------+ +-----------+ | Org files | ----&gt; | direct org | ----&gt; | Modified | | | ----&gt; | html export | ----&gt; | html | +-----------+ +---------------+ +-----------+ | | +---------------+ +-----------+ | Neccasary info| ----&gt; | navigtion | | eg title, date| ----&gt; | files | +---------------+ +-----------+ </pre> </div> <p> Of course, any good static site generator needs a good templating system. So since <i>genorg</i> used perl, I had a obvious choice ahead: <a href="https://template-toolkit.org/">Template::Toolkit</a>. Since it used C code with perl bindings, it was extremly fast. But still very powerful since it has been around for a while. </p> <label for="mn-auto.2232248" class="margin-toggle">&oplus;</label><input type="checkbox" id="mn-auto.2232248" class="margin-toggle"><div class="marginnote" id="org2dc1f56"> <p> A example info file generated by genorg to communicate with genserve: </p> <div class="org-src-container"> <pre class="src src-js-json">{ <span style="font-style: italic;">"landing"</span>: <span style="font-style: italic;">"templates/index.html.tt"</span>, <span style="font-style: italic;">"blog_dir"</span>: <span style="font-style: italic;">"/blog/"</span>, <span style="font-style: italic;">"rss_dir"</span>: <span style="font-style: italic;">"/rss/:cat"</span>, <span style="font-style: italic;">"main_rss"</span>: <span style="font-style: italic;">"templates/main.xml"</span>, <span style="font-style: italic;">"blog_file"</span>: <span style="font-style: italic;">"templates/blog.html.tt"</span>, <span style="font-style: italic;">"cpath"</span>: [ { <span style="font-style: italic;">"file"</span>: <span style="font-style: italic;">"templates/1.html"</span>, <span style="font-style: italic;">"rss"</span>: <span style="font-style: italic;">"templates/1.html.xml"</span>, <span style="font-style: italic;">"cat"</span>: <span style="font-style: italic;">"tech"</span> } ], <span style="font-style: italic;">"files"</span>: [ { <span style="font-style: italic;">"cat"</span>: <span style="font-style: italic;">"tech"</span>, <span style="font-style: italic;">"art"</span>: <span style="font-style: italic;">"introblog"</span>, <span style="font-style: italic;">"file"</span>: <span style="font-style: italic;">"2025/intro.org.html"</span> }, { <span style="font-style: italic;">"cat"</span>: <span style="font-style: italic;">"tech"</span>, <span style="font-style: italic;">"file"</span>: <span style="font-style: italic;">"2025/window.org.html"</span>, <span style="font-style: italic;">"art"</span>: <span style="font-style: italic;">"new_window_cmds"</span> } ], <span style="font-style: italic;">"main_rss_url"</span>: <span style="font-style: italic;">"/rss"</span> } </pre> </div> </div> <p> The navigation files are considered stuff like the category pages. To keep the urls the same even when a org file is moved, the site needs to dynamically resolve links into respsecite file paths. <code>example.com/category/article-id</code> needs to find the file and serve it. </p> </div> <div id="outline-container-org7161a33" class="outline-4"> <h4 id="org7161a33">Why perl?</h4> <div class="outline-text-4" id="text-org7161a33"> <blockquote> <p> Lisp has all the visual appeal of oatmeal with fingernail clippings mixed in. </p> <footer>Larry Wall</footer> </blockquote> <p> Larry Wall, as always, puts it very well. The other reasons are because of <a href="https://en.wiktionary.org/wiki/TMTOWTDI#English">TIMTOWDI</a>, and typed containers (I like these way more than I should). </p> </div> </div> </div> <div id="outline-container-org194cf40" class="outline-3"> <h3 id="org194cf40"><code>genserve</code></h3> <div class="outline-text-3" id="text-org194cf40"> <p> So now to serve the dynamicly serve the genorg output, all we have to do is parse the json file and redirect files accordingly. Easy enough&hellip; right? </p> <p> Well, it would be if I was satisfied with http requests taking 0.0001 seconds to be proccesed by genorg instead of 0.00001 seconds. </p> <p> So I initally decided to make the http server part in Go. This did not go well, I didn't like the language, I didn't like the http server the standard library provided. So in about one day, I wrote <b>300+ lines</b> of zig code to make it work. </p> <p> Although the process was tedious, the result was worth it, as any visitors get to save approximately \(10 \times 10^-5\,seconds\) for every visit. </p> </div> </div> </section> <section id="outline-container-org0043671" class="outline-2"> <h2 id="org0043671">Code</h2> <div class="outline-text-2" id="text-org0043671"> <p> My beautiful code can be found <a href="http://localhost:3000/asset/genorg">here</a>. As for the http server code, I won't share that. Simply cause it's crappy code and it's going to be easy to find exploits in it. If you do decide to use <code>genorg</code>, I suggest using a fastcgi script to serve content based of the parsed <code>json</code>. </p> </div> </section> <section id="outline-container-org0c8fbd7" class="outline-2"> <h2 id="org0c8fbd7">What now?</h2> <div class="outline-text-2" id="text-org0c8fbd7"> <p> I'm very happy with the software used to generate the blog and articles, but I still want to add some HTML and CSS and images in the home page and category pages to make the site more vibrant (I've recived feedback that this site reminds a viewer of a 'bee'). Maybe later, I'll write about the non-technical aspect of blogs and why I wanted to have one. </p> </div> </section> </article> </body> </html>
